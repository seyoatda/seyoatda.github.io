


[{"content":"","date":"2021å¹´7æœˆ11æ—¥","externalUrl":null,"permalink":"/","section":"","summary":"","title":"","type":"page"},{"content":"","date":"2021å¹´7æœˆ11æ—¥","externalUrl":null,"permalink":"/life/","section":"Lives","summary":"","title":"Lives","type":"life"},{"content":"ä»”ç»†æƒ³æƒ³ï¼Œç°åœ¨è·ç¦»ä¸Šæ¬¡å†™åšå®¢å·²ç»è¿‡å» 4 ä¸ªæœˆäº†ã€‚ä¸€æ–¹é¢æ˜¯è‡ªå·±çš„æƒ°æ€§å¯¼è‡´å†™ä½œåŠ¨åŠ›ä¸è¶³ï¼›å¦ä¸€æ–¹é¢è¿™å‡ ä¸ªæœˆæ¢äº†æ–°çš„å·¥ä½œï¼Œä¹Ÿæ˜¯æ²¡æœ‰è¶³å¤Ÿçš„çŸ¥è¯†ç§¯ç´¯ï¼Œæ¯•ç«Ÿæˆ‘ä¹Ÿæ˜¯å¯¹è‡ªå·±å†™çš„ä¸œè¥¿æœ‰åŸºæœ¬çš„è¦æ±‚çš„ã€‚æœ€è¿‘åœ¨ç ”ç©¶ Godot å¼•æ“ï¼Œæ‰“ç®—è‡ªå·±æ‘¸ç´¢ç€åšä¸€ä¸‹ä¿¯è§†è§’çš„ 2D æ¸¸æˆï¼Œåœ¨æŸ¥é˜…æ–‡æ¡£é€”ä¸­çœ‹åˆ°äº†ä¸€ä½åŒå¿—å†™çš„åšå®¢ç³»åˆ—æŒºä¸é”™çš„ï¼šlinkï¼Œé‚åˆå°è¯•æ‹¾èµ·å†™åšå®¢çš„ä¹ æƒ¯ã€‚\nç°åœ¨æ˜¯ 7 æœˆåˆï¼Œä¹Ÿæ˜¯ä¸‹åŠå¹´çš„å¼€ç«¯äº†ï¼Œé‚£ä¹ˆä¹Ÿåœ¨è¿™é‡Œç»™è‡ªå·±å®šä¸€ä¸ªä¸‹åŠå¹´çš„è®¡åˆ’åšä¸ºæŒ‡å¯¼ï¼š\næ¯æœˆè‡³å°‘è¾“å‡º 3 ç¯‡æŠ€æœ¯åšå®¢ å¯¹ Godot ç ”ç©¶å¹¶åšå‡ºæ¸¸æˆåŸå‹ ä¸‹åŠå¹´é˜…è¯»å®Œ 2 æœ¬æŠ€æœ¯ä¹¦ï¼Œå¹¶å†™å‡ºè¯»ä¹¦ç¬”è®° å½“ç„¶ï¼Œä¸Šé¢çš„è®¡åˆ’ä¸»è¦è¿˜æ˜¯é’ˆå¯¹æŠ€æœ¯æ–¹é¢ï¼Œè€Œä¸”åˆ—å¾—è¾ƒä¸ºå®½æ¾ï¼Œæ¯•ç«Ÿæˆ‘ä¹Ÿæ˜¯ä¸ªè€æ‹–å»¶ç—‡äº†ã€‚æ­¤å¤–å¯¹éæŠ€æœ¯å†…å®¹çš„è¾“å‡ºæˆ‘è§‰å¾—å°±éšå¿ƒè€Œä¸ºå§ï¼Œå¸Œæœ›åœ¨æ–°çš„ä¸‹åŠå¹´èƒ½å¤Ÿç»§ç»­åŠªåŠ›~~\n","date":"2021å¹´7æœˆ11æ—¥","externalUrl":null,"permalink":"/life/%E9%87%8D%E5%90%AF%E4%B9%8B%E8%B7%AF/","section":"Lives","summary":"","title":"é‡å¯ä¹‹è·¯","type":"life"},{"content":"","date":"2021å¹´3æœˆ28æ—¥","externalUrl":null,"permalink":"/poetry/","section":"Poetries","summary":"","title":"Poetries","type":"poetry"},{"content":"","date":"2021å¹´3æœˆ28æ—¥","externalUrl":null,"permalink":"/poetry/%E6%97%A0%E9%A2%98/","section":"Poetries","summary":"","title":"æ— é¢˜","type":"poetry"},{"content":" è¿™ä¸–ç•Œ\nå¤§æ¦‚å°±æ˜¯è¿™ä¸ªæ ·å­çš„å§\nä¸€æ ·çš„å¤œæ™šï¼Œä¸€æ ·çš„æ­Œ\nä¸€æ ·çš„å¿ƒæƒ…\nå å…¥è¿™æ— è¾¹çš„å¤œ\nç­‰ç€ä¸–ç•Œå°†æˆ‘å”¤é†’\næŠŠæˆ‘çš„æ— çŸ¥\nå†æ¬¡èµ‹ç»™æˆ‘\nå¤œæ™šçš„äººä»¬ï¼Œæ€ç»ªå¾€å¾€æ¯”åœ¨ç™½å¤©æ›´åŠ å¤šæ„å–„æ„Ÿã€‚19 å¹´ 3 æœˆå†™ä¸‹æ­¤è¯—ã€‚è§‰å¾—å 3 å¥æœ‰äº›æ„å¢ƒåœ¨å…¶ä¸­ã€‚\n","date":"2021å¹´3æœˆ28æ—¥","externalUrl":null,"permalink":"/poetry/%E5%A4%9C/","section":"Poetries","summary":"","title":"å¤œ","type":"poetry"},{"content":"","date":"2021å¹´3æœˆ8æ—¥","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":" Python ä¸­çš„\u0026quot;self\u0026quot;æ˜¯ä»€ä¹ˆ # åœ¨ä½¿ç”¨ pycharm ç¼–å†™ Python æ—¶ï¼Œè‡ªåŠ¨è¡¥å…¨æ€»ä¼šæŠŠå‡½æ•°å®šä¹‰çš„ç¬¬ä¸€ä¸ªå‚æ•°å®šä¹‰ä¸º self ã€‚é‚æŸ¥ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š\nself å¤§ä½“ä¸Šå’Œé™æ€è¯­è¨€å¦‚ Java ä¸­çš„ this å…³é”®å­—ç±»ä¼¼ï¼Œç”¨äºæŒ‡ä»£å®ä¾‹å˜é‡ã€‚åªæ˜¯åœ¨ Python ä¸­éœ€è¦ä¸»åŠ¨å®šä¹‰åœ¨å‡½æ•°çš„å‚æ•°ä¸­ã€‚ä½†æ˜¯é€šè¿‡å®ä¾‹è°ƒç”¨æ–¹æ³•æ—¶ï¼Œæ— é¡»ä¼ å…¥ self å‚æ•°ã€‚ self ä¸æ˜¯å…³é”®å­—ï¼Œåªæ˜¯ä¸€ç§å®˜æ–¹æ¨èå†™æ³•ï¼Œä¹Ÿå¯ä»¥å†™æˆå…¶ä»–çš„åç§°ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“é€ æˆè¯¯è§£ï¼Œæ‰€ä»¥ä¸æ¨èã€‚ ç”±ä¸Šæ–¹çš„çŸ¥è¯†å¯çŸ¥ï¼šå¦‚æœä¸€ä¸ªå‡½æ•°å¦‚æœä¸æ˜¯å®šä¹‰åœ¨ç±»ä¸­ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å®šä¹‰ self å˜é‡äº†ã€‚å³ä½¿å®šä¹‰äº†ï¼Œä¹Ÿä¼šä½œä¸ºä¸€ä¸ªæ™®é€šçš„å‚æ•°ä½¿ç”¨ï¼Œå‚è€ƒä¸‹æ–¹çš„ä»£ç ï¼š\ndef outer_func(self, val2): print(self, \u0026#34;\\n\u0026#34; + val2) outer_func(\u0026#34;just a common parameter\u0026#34;, \u0026#34;another common parameter\u0026#34;) # æ‰§è¡Œç»“æœ # just a common parameter # another common parameter ","date":"2021å¹´3æœˆ8æ—¥","externalUrl":null,"permalink":"/tech/python-%E4%B8%AD%E7%9A%84-self-%E6%98%AF%E4%BB%80%E4%B9%88/","section":"Teches","summary":"","title":"Python ä¸­çš„ã€Œselfã€æ˜¯ä»€ä¹ˆï¼Ÿ","type":"tech"},{"content":"","date":"2021å¹´3æœˆ8æ—¥","externalUrl":null,"permalink":"/tech/","section":"Teches","summary":"","title":"Teches","type":"tech"},{"content":"ç”Ÿæ´»æ˜¯ä»€ä¹ˆ\n","date":"2021å¹´3æœˆ8æ—¥","externalUrl":null,"permalink":"/about/","section":"","summary":"","title":"å…³äº","type":"page"},{"content":" ç«™åœ¨åœ°ä¸‹é€šé“å…¥å£\nä¸€çœ¼å°±èƒ½çœ‹åˆ°å°½å¤´çš„åœ°é“ç«™\næˆ‘å‘ç€å®ƒèµ°å»\nå°±åƒèµ°å‘æˆ‘å¹³åº¸çš„ç”Ÿæ´»\nç»§ç»­é‡è¹ˆè¦†è¾™\næˆ‘çœ‹å‘äººç¾¤\nä»–ä»¬å¹³é™å¦‚æ°´é¢\nç­‰å¾…è¢«å¾®é£å¹çš±\næˆ–æ˜¯è¢«ä¸€å—çŸ³å­ç‚¸èµ·\né‚£äº›æ”¯ç¦»ç ´ç¢ä¸ä¼šç•™ä¸‹ä»»ä½•ç—•è¿¹\næˆ‘ä¹Ÿæ˜¯å…¶ä¸­ä¸€å‘˜\næˆ‘å¿ƒçŸ¥è‚šæ˜\n2æœˆä»½æŸå¤©ä¸‹ç­ï¼Œäºä½“è‚²è¥¿è·¯åœ°ä¸‹é€šé“å…¥å£å¤„ï¼ŒæŠ¬å¤´ä¸€çœ¼èƒ½æœ›åˆ°åœ°é“ç«™å…¥å£ã€‚è€Œæˆ‘ä¸å¾—ä¸é¡ºç€äººæ½®èµ°å‘å®ƒã€‚æœ‰æ„Ÿï¼Œé‚ä½œæ­¤è¯—ã€‚\n","date":"2021å¹´2æœˆ27æ—¥","externalUrl":null,"permalink":"/poetry/%E5%9C%B0%E4%B8%8B%E9%80%9A%E9%81%93%E5%85%A5%E5%8F%A3%E5%A4%84%E9%9A%8F%E6%83%B3/","section":"Poetries","summary":"","title":"åœ°ä¸‹é€šé“å…¥å£å¤„éšæƒ³","type":"poetry"},{"content":" ä»€ä¹ˆæ˜¯åŒé‡åˆ†æ´¾ # ä»€ä¹ˆæ˜¯åˆ†æ´¾ï¼ˆdispatchï¼‰ # é¦–å…ˆæˆ‘ä»¬éœ€è¦ç†è§£ã€Œåˆ†æ´¾ã€çš„å«ä¹‰ã€‚åˆ†æ´¾å°±æ˜¯å°†æ–¹æ³•è°ƒç”¨ä¸å¯¹åº”çš„å…·ä½“æ–¹æ³•ç»‘å®šèµ·æ¥ã€‚è€Œåˆ¤æ–­çš„ä¾æ®æœ‰ä¸¤ç‚¹ï¼Œè¿™ä¸¤è€…å¯ç§°ä¸ºã€Œå®—é‡ã€ï¼š\næ–¹æ³•çš„æ¥æ”¶è€…ï¼Œä¹Ÿå°±æ˜¯å“ªä¸ªå¯¹è±¡è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³• æ–¹æ³•çš„å‚æ•°ï¼Œè°ƒç”¨æ–¹æ³•æ—¶ä¼ é€’è¿‡æ¥çš„å‚æ•° è€Œä¸åŒçš„åˆ¤æ–­æ–¹æ³•ä¹Ÿå°±äº§ç”Ÿäº†ä¸åŒçš„åˆ†æ´¾ç±»å‹ï¼š\né™æ€åˆ†æ´¾ V.S. åŠ¨æ€åˆ†æ´¾\nå•é‡åˆ†æ´¾ V.S. å¤šé‡åˆ†æ´¾\nä¸‹é¢ä»¥æˆ‘çš„ç†è§£ç®€å•åœ°æ€»ç»“ä¸€ä¸‹è¿™å‡ ä¸ªåè¯çš„å«ä¹‰ï¼š\né™æ€åˆ†æ´¾ï¼šé™æ€åˆ†æ´¾åœ¨ç¼–è¯‘æœŸè¿›è¡Œï¼Œåªæ ¹æ®å®—é‡çš„é™æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œåœ¨ç¼–è¯‘å®Œæˆåä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚ä¹Ÿå¯ç§°ä¸ºã€Œç¼–è¯‘æœŸå¤šæ€ã€ã€‚\nåŠ¨æ€åˆ†æ´¾ï¼šåŠ¨æ€åˆ†æ´¾åœ¨è¿è¡ŒæœŸè¿›è¡Œï¼Œæ ¹æ®å®—é‡çš„åŠ¨æ€ç±»å‹æ¥åˆ¤æ–­éœ€è¦è°ƒç”¨å“ªä¸ªæ–¹æ³•ã€‚ä¹Ÿç§°ã€Œè¿è¡Œæ—¶å¤šæ€ã€ã€‚\nå¤šé‡åˆ†æ´¾ï¼šè™½ç„¶è¯´ multiple æ˜¯ã€Œå¤šé‡ã€çš„æ„æ€ï¼Œä½†æ˜¯å®é™…ä¸Šä¹Ÿå¯ç§°ä¸ºã€ŒåŒé‡åˆ†æ´¾ã€ã€‚å¤šé‡åˆ†æ´¾å°±æ˜¯åŒæ—¶æ ¹æ®ä¸¤ç§å®—é‡çš„ç±»å‹è¿›è¡Œåˆ¤æ–­ã€‚\nå•é‡åˆ†æ´¾ï¼šå•é‡åˆ†æ´¾å°±æ˜¯åªæ ¹æ®å…¶ä¸­ä¸€ç§å®—é‡è¿›è¡Œåˆ¤æ–­ã€‚\næ‰€ä»¥å…¶å®è¿™ä¸¤ç»„è¯æ˜¯ä»ä¸¤ä¸ªä¸åŒçš„è§’åº¦æ¥æè¿°åˆ†æ´¾çš„ç±»å‹ï¼Œå¹¶ä¸å†²çªã€‚\nJava ä¸­çš„åˆ†æ´¾æœºåˆ¶ # åœ¨ç½‘ä¸Šå¾ˆå¤šåšå®¢è¯´ Java ä¸­æ˜¯å•é‡åˆ†æ´¾ï¼›ä¹Ÿæœ‰äººè¯´ Java ä¸­å®é™…ä¸Šæ˜¯é™æ€åŒé‡åˆ†æ´¾ï¼ŒåŠ¨æ€å•é‡åˆ†æ´¾ã€‚ä¸‹é¢æ˜¯æˆ‘çš„æ¨è®ºå’Œæ€»ç»“ã€‚\nJava ä¸­çš„é‡è½½æœºåˆ¶ï¼Œæ˜¯é™æ€åˆ†æ´¾ï¼Œå…¶æ ¹æ®æ–¹æ³•ä¼ å…¥å‚æ•°çš„é™æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œè€Œæ–¹æ³•çš„æ¥æ”¶è€…ï¼Œä¹Ÿç›´æ¥åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šã€‚æ‰€ä»¥æ˜¯é™æ€çš„åŒé‡åˆ†æ´¾ã€‚\nè€Œé‡å†™æœºåˆ¶ï¼Œè‚¯å®šæ˜¯åŠ¨æ€åˆ†æ´¾äº†ã€‚ä½†æ˜¯å…¶åªæ ¹æ®æ–¹æ³•æ¥æ”¶è€…çš„åŠ¨æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ã€‚å¹¶ä¸ä¼šæ ¹æ®æ–¹æ³•å‚æ•°çš„åŠ¨æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ã€‚æ‰€ä»¥æ˜¯åŠ¨æ€çš„å•é‡åˆ†æ´¾ã€‚\né‚£å¦‚æœä¸€ä¸ªæ–¹æ³•åŒæ—¶è¢«é‡å†™å’Œé‡è½½äº†å‘¢ï¼Œé‚£è¿™ä¸ªæ–¹æ³•å±äºä»€ä¹ˆåˆ†æ´¾æœºåˆ¶å‘¢ï¼Ÿæˆ‘è®¤ä¸ºï¼Œé‡å†™å’Œé‡è½½æœ¬æ¥å°±åˆ†åˆ«æ˜¯ç¼–è¯‘æœŸå’Œè¿è¡ŒæœŸçš„å¤šæ€æœºåˆ¶ï¼Œå°±æ˜¯åˆ†å¼€è¿›è¡Œè®¨è®ºçš„ï¼Œåœ¨ç¨‹åºä¸åŒç”Ÿå‘½å‘¨æœŸæ—¶é—´æ®µçš„åˆ†æ´¾æœºåˆ¶ç›´æ¥åˆ†å¼€è®¨è®ºå¹¶è¿›è¡Œå®šä¹‰å°±å¥½äº†ã€‚\nè®¿é—®è€…æ¨¡å¼ä¸ä¼ªåŒé‡åˆ†æ´¾ # è™½ç„¶è¯´ Java åœ¨ç¼–è¯‘æœŸè¡¨ç°å‡ºäº†å¤šé‡åˆ†æ´¾ï¼Œä½†æ˜¯ä¹Ÿåªèƒ½å®šæ€§ä¸ºå•é‡åˆ†æ´¾è¯­è¨€ï¼Œè€Œè¿™åœ¨è®¾è®¡ä»£ç æ—¶å°±ä¼šå¼•èµ·ä¸€äº›ä¸ä¾¿ï¼šåœ¨è°ƒç”¨æ–¹æ³•æ—¶æ— æ³•æ ¹æ®å‚æ•°çš„åŠ¨æ€ç±»å‹æ¥åˆ†æ´¾å¯¹åº”çš„æ–¹æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬åªèƒ½æ›²çº¿æ•‘å›½ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®ç°ä¼ªåŠ¨æ€åŒé‡åˆ†æ´¾ã€‚\ninstanceof # åœ¨æ–¹æ³•å†…éƒ¨å¯ä»¥é€šè¿‡ Java çš„ instanceof å…³é”®å­—æ¥åˆ¤æ–­å¯¹è±¡çš„åŠ¨æ€ç±»å‹ã€‚é€šè¿‡åˆ†æ”¯é€‰æ‹©æ¥è¿›è¡Œå¯¹åº”çš„å¤„ç†æ“ä½œã€‚ä½†æ˜¯è¿™ç§æ€è·¯ä¼šè®©å¤„ç†ä»£ç å˜å¾—ååˆ†è‡ƒè‚¿ï¼Œè€Œä¸”è¿èƒŒäº†ã€Œå¼€é—­åŸåˆ™ã€ã€‚æ¯æ¬¡è¦æ–°å¢ä¸€ä¸ªè¢«å¤„ç†ç±»æ—¶ï¼Œå°±è¦ä¿®æ”¹ä»£ç æ–°å¢ä¸€ä¸ªåˆ†æ”¯è¿›è¡Œå¤„ç†ã€‚å…·ä½“çš„å®ç°æ–¹æ³•å¾ˆç®€å•ï¼Œä¸èµ˜è¿°ã€‚\nè®¿é—®è€…æ¨¡å¼ # è®¾è®¡æ¨¡å¼ä¸­çš„ã€Œè®¿é—®è€…æ¨¡å¼ã€å°±æ˜¯é€šè¿‡åˆ©ç”¨ä¼ªåŒé‡åˆ†æ´¾æ¥å®ç°çš„ã€‚ä¸»è¦æ€è·¯å¦‚ä¸‹ï¼š\nè®¾è°ƒç”¨æ–¹ä¸ºã€Œç±» A ã€ï¼Œè¢«è°ƒç”¨æ–¹ä¸ºã€Œç±» B ã€ã€‚é€šè¿‡åè½¬è°ƒç”¨æ–¹å’Œè¢«è°ƒç”¨æ–¹ï¼Œè®©ç±» A é‡å†™æ–¹æ³•æ¥è°ƒç”¨ç±» B çš„é‡è½½æ–¹æ³•ã€‚é€šè¿‡ this å˜é‡å°†ç±» A çš„åŠ¨æ€ç±»å‹ä¼ é€’ç»™ç±» B çš„é‡è½½æ–¹æ³•ï¼Œå®ç°äº†ä¼ªåŒé‡åˆ†æ´¾ã€‚\nåœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³è®© Player.play() æ–¹æ³•æ ¹æ® Instrument çš„åŠ¨æ€ç±»å‹æ¥åˆ†åˆ«è°ƒç”¨å¯¹åº”çš„é‡è½½æ–¹æ³•ï¼Œä»è€Œè¿›è¡Œä¸åŒçš„å¤„ç†ï¼š\nclass Player { void play(Instrument instrument) { System.out.println(\u0026#34;instrument notes\u0026#34;); } void play(Violin violin) { System.out.println(\u0026#34;player starts playing violin\u0026#34;); violin.note(); } void play(Piano piano) { System.out.println(\u0026#34;player starts playing piano\u0026#34;); piano.note(); } } class Instrument { void note() { System.out.println(\u0026#34;instrument notes\u0026#34;); } void accept(Player player) { player.play(this); } } class Violin extends Instrument { @Override public void note() { System.out.println(\u0026#34;violin notes\u0026#34;); } @Override public void accept(Player player) { player.play(this); } } class Piano extends Instrument { @Override public void note() { System.out.println(\u0026#34;piano notes\u0026#34;); } @Override public void accept(Player player) { player.play(this); } } public class Main { public static void main(String[] args) { Player player = new Player(); System.out.println(\u0026#34;-------åŒé‡åˆ†æ´¾-------\u0026#34;); Instrument[] instruments = {new Violin(), new Piano()}; for (Instrument instrument : instruments) { instrument.accept(player); } System.out.println(\u0026#34;-------å•é‡åˆ†æ´¾-------\u0026#34;); for (Instrument instrument : instruments) { player.play(instrument); } } } // ç»“æœ /* -------åŒé‡åˆ†æ´¾------- player starts playing violin violin notes player starts playing piano piano notes -------å•é‡åˆ†æ´¾------- instrument notes instrument notes */ ä»ä¸Šæ–¹çš„ä»£ç è¿è¡Œç»“æœå¯ä»¥å¾—çŸ¥ï¼Œåœ¨è°ƒç”¨é‡è½½æ–¹æ³•æ—¶ï¼Œä¸ä¼šæ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œè€Œæ˜¯æ ¹æ®é™æ€ç±»å‹åˆ¤æ–­ï¼Œåªä¼šè°ƒç”¨ play(Instrument) æ–¹æ³•ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬åœ¨é‡è½½ Player çš„æ–¹æ³•æ—¶å¯ä»¥ç›´æ¥è°ƒç”¨ Instrument.note() æ–¹æ³•ï¼Œè®©ç¼–è¯‘å™¨å»è°ƒç”¨å­ç±»é‡å†™åçš„æ–¹æ³•ã€‚\nä½†æ˜¯ä½¿ç”¨åŒé‡åˆ†æ´¾çš„æ„ä¹‰åœ¨äºï¼Œ æŠŠå…·ä½“çš„å¤„ç†é€»è¾‘æ”¾åœ¨è°ƒç”¨è€… Player ç±»çš„æ–¹æ³•ä¸­ï¼Œå‡å°‘å¯¹ Instrument çš„å®ç°ç±»çš„ä¿®æ”¹ã€‚äº‹å®ä¸Š Instrument çš„å­ç±»åªéœ€è¦å®ç°ä¸€ä¸ª accept(Player) æ–¹æ³•å³å¯ã€‚\nè®¿é—®è€…æ¨¡å¼çš„å‡ºç°åŸºæœ¬ä¸Šä¹Ÿå°±æ˜¯å› ä¸º Java è¿™ç±»è¯­è¨€çš„å•é‡åˆ†æ´¾ç‰¹æ€§å§ã€‚å¦‚æœæ˜¯å¤šé‡åˆ†æ´¾çš„è¯­è¨€ï¼Œå°±å¯ä»¥ç›´æ¥åˆ©ç”¨è¯­è¨€ç‰¹æ€§äº†ã€‚\nå‚è€ƒæ–‡ç« ï¼š\né¢å‘å¯¹è±¡è¯­è¨€çš„å¤šåˆ†æ´¾ã€å•åˆ†æ´¾ã€åŒé‡åˆ†æ´¾ What is dispatching in JAVA? ","date":"2020å¹´12æœˆ20æ—¥","externalUrl":null,"permalink":"/tech/java%E4%B8%AD%E7%9A%84%E5%A4%9A%E9%87%8D%E5%88%86%E6%B4%BE%E4%B8%8E%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/","section":"Teches","summary":"","title":"Java ä¸­çš„å¤šé‡åˆ†æ´¾ä¸è®¿é—®è€…æ¨¡å¼","type":"tech"},{"content":"","date":"2020å¹´8æœˆ1æ—¥","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":" 1. Kuduçš„åŸç† # 1.1 æ¦‚è¿° # Kuduæ˜¯ä¸€ä¸ªç±»ä¼¼Hbaseçš„åˆ—å¼å­˜å‚¨åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œå®ƒçš„å®šä½ä»‹äºhdfså’Œhbaseä¹‹é—´ã€‚\nhdfsï¼šä½¿ç”¨åˆ—å¼å­˜å‚¨ï¼Œé€‚åˆOLAPï¼Œä¸æ”¯æŒå•æ¡çºªå½•çº§åˆ«çš„æ›´æ–°æ“ä½œï¼Œéšæœºè¯»å†™æ€§èƒ½å·®ï¼Œä¸é€‚åˆç”¨æ¥ä½œå®æ—¶æŸ¥è¯¢ã€‚ hbaseï¼šå¯ä»¥é«˜æ•ˆåœ°éšæœºè¯»å†™ï¼Œé€‚ç”¨OLTPï¼Œä½†æ˜¯ä¸é€‚ç”¨äºSQLï¼Œä¸”å¤§æ•°æ®é‡æ—¶è¯»æ€§èƒ½è¾ƒå·®ã€‚ Kuduå°±æ˜¯ç»“åˆäº†ä¸¤è€…çš„ä¼˜ç‚¹ï¼Œå¹³è¡¡äº†ä¸¤è€…çš„ç¼ºç‚¹ã€‚ä»è€ŒåŒæ—¶åœ¨OLTPå’ŒOLAPä¸­éƒ½æä¾›è¾ƒå¥½çš„æ€§èƒ½ã€‚è¿™æ ·å°±æ— éœ€ä¸ºäº†è§£å†³ä»¥ä¸Šä¸¤è€…çš„ç¼ºç‚¹è€Œæ­å»ºä¸¤ç§æ¶æ„ã€‚\n1.2 åŸºæœ¬æ¦‚å¿µ # Tableï¼šæ˜¯ä¸€å¼ è¡¨ï¼Œå…·æœ‰å…¨å±€çš„ä¸»é”®ï¼Œä¸€å¼ tableå¯ä»¥åˆ†ä¸ºå¤šä¸ªæ®µï¼Œå³tabletã€‚\nTabletï¼šä¸€ä¸ªtabletæ˜¯ä¸€å¼ è¡¨è¿ç»­çš„ä¸€ä¸ªæ®µï¼Œç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“çš„partitionåˆ†åŒºã€‚\nTablet serverï¼šå­˜å‚¨tabletï¼Œå¹¶ä¸”å‘å®¢æˆ·ç«¯æä¾›è¯»å–æ•°æ®çš„æœåŠ¡ã€‚\nå¯¹äºæŒ‡å®šçš„tabletï¼Œæœ‰ä¸€ä¸ªserverä½œä¸ºleaderï¼ŒåŸºä½™serverä½œä¸ºfollowerå‰¯æœ¬ã€‚åªæœ‰leaderå¤„ç†å†™è¯·æ±‚ï¼Œfollowerè´Ÿè´£å’ŒleaderåŒæ­¥æ•°æ®ï¼Œå¹¶ä¸”æä¾›è¯»æœåŠ¡ã€‚\nMasterï¼šä¸»è¦ç”¨äºç®¡ç†å…ƒæ•°æ®ï¼Œç›‘å¬tserver(tablet server)çš„çŠ¶æ€ã€‚å½“clientå‘å‡ºè¯·æ±‚æ—¶ï¼Œå…¶å…ˆå¯¹è¯·æ±‚åšæ ¡éªŒï¼Œå†åˆ†é…tserverç»™clientè¿›è¡Œè¯·æ±‚ã€‚\n2. Kuduçš„å®‰è£… # 2.1 å‰ç½®æ¡ä»¶ # ä»¥ä¸‹æ˜¯å®˜æ–¹æ–‡æ¡£ä¸­ç»™å‡ºçš„ä¸€äº›æ¡ä»¶ï¼š\nç¡¬ä»¶ # è‡³å°‘ä¸€ä¸ªä¸»æœºæ¥ä½œä¸ºKuduçš„MasterèŠ‚ç‚¹ï¼ŒMasterèŠ‚ç‚¹æ•°å¿…é¡»æ˜¯å¥‡æ•°ï¼Œæ¨èé…ç½®1ä¸ªæˆ–è€…3ä¸ªã€‚\nè‡³å°‘ä¸€ä¸ªä¸»æœºæ¥ä½œä¸ºtabletèŠ‚ç‚¹ï¼Œå¦‚æœéœ€è¦å¤‡ä»½å¤åˆ¶ï¼Œé‚£ä¹ˆè‡³å°‘éœ€è¦3ä¸ªæœåŠ¡å™¨\n2kä¸ªæ•°é‡çš„MasterèŠ‚ç‚¹å’Œ2k-1ä¸ªèŠ‚ç‚¹çš„å®¹é”™ç­‰çº§æ˜¯ä¸€æ ·çš„ã€‚4ä¸ªèŠ‚ç‚¹å’Œ3ä¸ªèŠ‚ç‚¹ä¸€æ ·ï¼Œåªèƒ½å®¹å¿ä¸€ä¸ªé”™è¯¯ã€‚2ä¸ªèŠ‚ç‚¹åˆ™ä¸èƒ½å®¹é”™ã€‚ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®˜æ–¹æ¨è1ä¸ªæˆ–3ä¸ªèŠ‚ç‚¹çš„åŸå› ï¼‰\næ‰€ä»¥ä½¿ç”¨1å°æœåŠ¡å™¨ä¹Ÿå¯ä»¥è¿›è¡ŒåŸºæœ¬çš„Kuduçš„å®‰è£…ä¸è¿è¡Œ\næ“ä½œç³»ç»Ÿ # Linux # RHEL / CentOS 6.6+ or Ubuntu 16 18 or Debian 8 ntpæœåŠ¡ xfs/ext4æ ¼å¼çš„ç£ç›˜ Windows # ä¸æ”¯æŒ ç£ç›˜ # å¦‚æœèƒ½ä½¿ç”¨SSDï¼Œä¼šæ˜¾è‘—åœ°æ”¹å–„Kuduçš„å»¶è¿Ÿ è‡³å°‘50GBä»¥ä¸Šçš„ç£ç›˜ç©ºé—´ï¼Œï¼ˆå®æµ‹æƒ³è¦å®Œæ•´ç¼–è¯‘ï¼Œè‡³å°‘éœ€è¦90GBä»¥ä¸Šï¼‰ Java # JDK8 ä»¥ä¸Šï¼Œä½†æ˜¯ä¸éœ€è¦JRE 2.2 æºç ç¼–è¯‘ # Kuduè™½ç„¶æä¾›äº†Dockerçš„è¿è¡Œæ–¹å¼ï¼Œä½†æ˜¯å®˜æ–¹å»ºè®®åªç”¨äºæµ‹è¯•å’Œå­¦ä¹ ï¼Œå¹¶ä¸æ¨èåœ¨æ­£å¼ç¯å¢ƒä½¿ç”¨Dockerè¿è¡Œã€‚æ‰€ä»¥æœ€å¥½ä»æºç ç¼–è¯‘ä¸€éã€‚\nç¼–è¯‘éœ€è¦ä½¿ç”¨åˆ°C++11çš„ç¼–è¯‘å™¨ï¼ˆGCC4.8)\nç¬”è€…ä½¿ç”¨çš„æ˜¯CentOS7.7ï¼Œä»¥ä¸‹åŸºäºè¯¥ç³»ç»Ÿè¿›è¡Œè¯´æ˜ã€‚\nCentOS # CentOS 7.0 ä»¥ä¸Šçš„ç‰ˆæœ¬å°±éœ€è¦å®‰è£…Red Hat Developer ToolsetåŒ…ç”¨äºè·å–C++ç¼–è¯‘å™¨ã€‚\nå®‰è£…ä¾èµ–\n$ sudo yum install autoconf automake cyrus-sasl-devel cyrus-sasl-gssapi \\ cyrus-sasl-plain flex gcc gcc-c++ gdb git java-1.8.0-openjdk-devel \\ krb5-server krb5-workstation libtool make openssl-devel patch \\ pkgconfig redhat-lsb-core rsync unzip vim-common which ç¬”è€…çš„ç³»ç»Ÿæ˜¯CentOS 7.7ï¼Œæ‰€ä»¥éœ€è¦å®‰è£…Toolsetã€‚\n$ DTLS_RPM=rhscl-devtoolset-3-epel-6-x86_64-1-2.noarch.rpm $ DTLS_RPM_URL=https://www.softwarecollections.org/repos/rhscl/devtoolset-3/epel-6-x86_64/noarch/${DTLS_RPM} $ wget ${DTLS_RPM_URL} -O ${DTLS_RPM} $ sudo yum install -y scl-utils ${DTLS_RPM} $ sudo yum install -y devtoolset-3-toolchain å®˜ç½‘ç»™å‡ºçš„urlå·²ç»å¤±æ•ˆï¼Œå®‰è£…å¤±è´¥ã€‚ä½†æ˜¯ç»éªŒè¯ï¼Œæ²¡æœ‰å®‰è£…ä¹Ÿèƒ½æ­£å¸¸ç¼–è¯‘ã€‚çŒœæµ‹æ˜¯åªéœ€è¦å®‰è£…äº†gccå¹¶ä¸”ç‰ˆæœ¬å¤§äº4.8å°±å¯ä»¥äº†ï¼Œå¯ä»¥ä½¿ç”¨gcc --versionå‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬ã€‚\n$ gcc --version gcc (GCC) 8.3.1 20191121 (Red Hat 8.3.1-5) Copyright (C) 2018 Free Software Foundation, Inc. This is free software; see the source for copying conditions. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. ä»githubä»“åº“ä¸­è·å–æºç \n$ git clone https://github.com/apache/kudu ä½¿ç”¨build-if-necessary.shè„šæœ¬å¯ä»¥æ„å»ºä»»ä½•ç¼ºå¤±çš„ç¬¬ä¸‰æ–¹ä¾èµ–ã€‚éœ€è¦ä½¿ç”¨åˆ°Pythonï¼Œæœ¬æ–‡ä¸­å®‰è£…çš„æ˜¯python 3.6ã€‚\n$ build-support/enable_devtoolset.sh thirdparty/build-if-necessary.sh ç„¶åè¿›è¡Œä¸€æ®µæ¼«é•¿çš„ç­‰å¾…è¿‡ç¨‹ã€‚\nç¬¬4æ­¥å®Œæˆåæ‰èƒ½è¿›è¿›æ­£å¼çš„ç¼–è¯‘è¿‡ç¨‹ï¼Œé€‰æ‹©ä¸€ä¸ªé™¤äº†kuduæ ¹ç›®å½•ä»¥å¤–çš„è¾“å‡ºç›®å½•ï¼Œè¿›è¡Œç¼–è¯‘ï¼š\n$ mkdir -p build/release $ cd build/release $ ../../build-support/enable_devtoolset.sh ../../thirdparty/installed/common/bin/cmake -DCMAKE_BUILD_TYPE=release --DNO_TESTS=1 ../.. $ make -j4 --DNO_TEST=1å‚æ•°çš„ä½œç”¨æ˜¯åœ¨ç¼–è¯‘æ—¶è·³è¿‡æµ‹è¯•å·¥ä½œçš„ç¼–è¯‘ï¼Œå¦åˆ™ç¼–è¯‘ç»“æœå°†ååˆ†å·¨å¤§ã€‚\nå®‰è£…æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‚æ•°æ¥è·³è¿‡æŒ‡å®šçš„ç»„ä»¶ï¼š\n-DKUDU_CLIENT_INSTALL=OFF è·³è¿‡kuduå®¢æˆ·ç«¯çš„å®‰è£… -DKUDU_TSERVER_INSTALL=OFFè·³è¿‡tserverçš„å®‰è£… -DKUDU_MASTER_INSTALL=OFFè·³è¿‡masterçš„å®‰è£… å‡å¦‚æŸä¸ªæœåŠ¡å™¨åªä½œä¸ºtserverä½¿ç”¨ï¼Œé‚£ä¹ˆå¯ä»¥è·³è¿‡masterçš„å®‰è£…ä»¥å‡å°‘ç£ç›˜èµ„æºå ç”¨å¹¶åŠ å¿«å®‰è£…è¿‡ç¨‹ã€‚\nç¼–è¯‘è¿‡ç¨‹è€—æ—¶ä¹Ÿååˆ†ä¹…ã€‚å–ä¸Šä¸€æ¯èŒ¶ğŸµæ…¢æ…¢ç­‰å¾…ã€‚\nå®Œæˆç¼–è¯‘åï¼Œæ„å»ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåº“æ–‡ä»¶å’Œå¤´æ–‡ä»¶ã€‚è¿›å…¥ä¸Šä¸€æ­¥ç¼–è¯‘çš„è¾“å‡ºç›®å½•ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤è¿›è¡Œæ„å»ºã€‚ç”¨DESTDIR=xxxæŒ‡å®šè‡ªå·±æƒ³è¦è¾“å‡ºçš„ä½ç½®ï¼Œå¦‚æœä¸æŒ‡å®šåˆ™é»˜è®¤è¾“å‡ºåˆ°/usr/local/ç›®å½•ä¸‹é¢ã€‚\nsudo make DESTDIR=/home/kudu install è‡³æ­¤æœ€åŸºæœ¬çš„ç¼–è¯‘å®‰è£…å°±å®Œæˆå•¦ğŸ˜Šï¼\n2.3 é…ç½®Kudu # æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å‘½ä»¤è¡Œå¯åŠ¨æ—¶ä¼ é€’å‚æ•°æ¥å¯¹Kuduè¿›è¡Œé…ç½®ï¼Œå½“å‚æ•°è¿‡å¤šæ—¶ï¼Œä¹Ÿå¯åœ¨å¯åŠ¨æ—¶ä½¿ç”¨â€“-flagfile=\u0026lt;file\u0026gt;å‚æ•°æ¥å¼•ç”¨é…ç½®æ–‡ä»¶ã€‚æ›´å¥‡å¦™åœ°æ˜¯ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­è¿˜å¯ä»¥é€šè¿‡--flagfile=\u0026lt;file\u0026gt;æ¥å†æ¬¡å¼•ç”¨å¦ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿™æ ·é…ç½®å‚æ•°å°±ç›¸å½“çµæ´»ã€‚\nMasterå’ŒTabletèŠ‚ç‚¹çš„é…ç½®å¯ä»¥æ”¾åœ¨åŒä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨è¯†åˆ«å“ªäº›æ˜¯å±äºè‡ªå·±çš„é…ç½®å‚æ•°ã€‚é…ç½®å‚æ•°çš„æ ¼å¼ä¸º-â€“flag=xxx ï¼Œå‰ç¼€å¯ä»¥ç”¨ä¸€ä¸ªæˆ–è€…äºŒä¸ª-éƒ½OKã€‚\n2.3.1 é…ç½®ç›®å½• # æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦æ‰‹åŠ¨é…ç½®ç›®å½•ã€‚\n--fs_wal_dirï¼šç”¨æ¥é…ç½®Kuduçš„å†™å‰æ—¥å¿—WALï¼ˆWrite-Ahead Logï¼‰çš„è¾“å‡ºç›®å½•ã€‚\n--fs_metadata_dirï¼šé…ç½®Kuduæ¯ä¸ªtabletçš„å…ƒæ•°æ®çš„å­˜æ”¾ç›®å½•\nå»ºè®®è¿™äº›ç›®å½•æ”¾åœ¨ä¸€ä¸ªé«˜æ€§èƒ½çš„ã€æœ‰é«˜å¸¦å®½çš„ç£ç›˜ä¸Šï¼Œä¾‹å¦‚SSDã€‚å¦‚æœ--fs_metadata_diræ²¡æœ‰æŒ‡å®šï¼Œé‚£ä¹ˆå…ƒæ•°æ®ä¼šæ”¾åœ¨WALçš„è¾“å‡ºç›®å½•ã€‚\n--fs_data_dirsï¼šæŒ‡å®šKuduç”¨äºå­˜æ”¾æ•°æ®å—çš„ç›®å½•ã€‚å¯ä»¥é€šè¿‡,åˆ†éš”æ·»åŠ å¤šä¸ªç›®å½•ï¼ŒKuduä¼šæŠŠæ•°æ®å¹³å‡åœ°å­˜åœ¨è¿™äº›ç›®å½•ä¸­ï¼Œå¦‚æœä¸æŒ‡å®šè¯¥å‚æ•°ï¼Œä¹Ÿæ˜¯ä¼šæŠŠæ•°æ®å—æ”¾åœ¨WALçš„è¾“å‡ºç›®å½•ä¸­ã€‚\n--fs_wal_dirå’Œ--fs_metadata_dirå¯ä»¥è®¾ç½®ä¸º--fs_data_dirsç»™å‡ºçš„ç›®å½•åˆ—è¡¨ä¸­çš„æŸä¸€ä¸ªç›®å½•ï¼Œä½†æ˜¯ä¸èƒ½æ˜¯ä»»ä½•ç›®å½•åˆ—è¡¨ä¸­ç›®å½•çš„å­ç›®å½•ã€‚\næ¯ä¸€ä¸ªç›®å½•éƒ½åªèƒ½è¢«ä¸€ä¸ªKuduè¿›ç¨‹ä½¿ç”¨ï¼Œæ‰€ä»¥å¤šä¸ªKuduè¿›ç¨‹è¦åˆ†åˆ«è®¾ç½®å±äºè‡ªå·±çš„å„ç§ç›®å½•ã€‚å¦åˆ™å¯åŠ¨å¯èƒ½ä¼šå¤±è´¥ã€‚\nä»¥ä¸Šæ˜¯ä¸€äº›æœ€åŸºæœ¬çš„è®¾ç½®ï¼Œæ›´å¤šå…³äºMasterèŠ‚ç‚¹çš„é…ç½®å¯åœ¨å®˜æ–¹ç½‘ç«™æŸ¥é˜…ï¼škudu-Masteré…ç½®é¡¹\n2.4 éƒ¨ç½²å®æˆ˜ # ç°åœ¨æœ‰5å°æœåŠ¡å™¨èµ„æºï¼Œç»è€ƒè™‘ï¼Œéƒ¨ç½²1ä¸ªMasterèŠ‚ç‚¹ï¼Œ3ä¸ªTabletèŠ‚ç‚¹ã€‚éƒ¨ç½²æƒ…å†µå¦‚ä¸‹ï¼š\næœåŠ¡å™¨IP å†…å­˜ ç£ç›˜ éƒ¨ç½²æœåŠ¡ 120.40.185.* 16GB ESSD äº‘ç›˜100GB ESSD äº‘ç›˜500GB Kudu Tablet 116.62.161.* 16GB ESSD äº‘ç›˜100GB ESSD äº‘ç›˜500GB Kudu Tablet 121.41.10.* 16GB ESSD äº‘ç›˜100GB ESSD äº‘ç›˜500GB Kudu Tablet 112.124.30.* 16GB ESSD äº‘ç›˜100GB ESSD äº‘ç›˜100GB Kudu Master 2.4.1 åŸºæœ¬è¿‡ç¨‹ # å…ˆåˆ†åˆ«åœ¨å››å°æœºä¸Šå®‰è£…Kuduï¼Œç”±äºæ¯å°æœåŠ¡å™¨åªæä¾›ä¸€ä¸ªMasteræˆ–TabletèŠ‚ç‚¹ï¼Œæ‰€ä»¥åœ¨å®‰è£…æ—¶å¯ä»¥è·³è¿‡ä¸éœ€è¦çš„éƒ¨åˆ†ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¯¹ç³»ç»Ÿèµ„æºçš„å ç”¨ã€‚å®‰è£…è¿‡ç¨‹å‚è€ƒä¸Šæ–‡ã€‚\nåœ¨å®‰è£…å®Œä¹‹åï¼Œåˆ†åˆ«ç¼–å†™é…ç½®æ–‡ä»¶ï¼š\n# tserveré…ç½® --fs_wal_dir=/home/kudu/kudu_data/tserver/wal --fs_data_dirs=/home/kudu/kudu_data/tserver/data --fs_metadata_dir=/home/kudu/kudu_data/tserver/metadata --log_dir=/home/kudu/kudu_data/tserver/logs --tserver_master_addrs=112.124.30.113:7051 --webserver_doc_root=/home/kudu/kudu/www # master é…ç½® --fs_wal_dir=/home/kudu/kudu_data/master/wal --fs_data_dirs=/home/kudu/kudu_data/master/data --fs_metadata_dir=/home/kudu/kudu_data/master/metadata --log_dir=/home/kudu/kudu_data/master/logs --webserver_doc_root=/home/kudu/kudu/www --trusted_subnets=0.0.0.0/0 masterå’Œtserverçš„å‰å››ä¸ªé…ç½®æ˜¯åœ¨2.3å°èŠ‚æåˆ°çš„åŸºæœ¬é…ç½®å‚æ•°ã€‚\n--webserver_doc_rootæ˜¯ä¸ºäº†èƒ½åœ¨8051ç«¯å£çœ‹åˆ°Kuduçš„MasterèŠ‚ç‚¹çš„ä¸€äº›è¯¦ç»†ä¿¡æ¯ï¼ˆtserverèŠ‚ç‚¹çš„é»˜è®¤ç«¯å£æ˜¯8050ï¼‰ã€‚éœ€è¦æŒ‡å®šé™æ€æ–‡ä»¶çš„è·¯å¾„ï¼Œå¦åˆ™åœ¨è®¿é—®8051ä¼šæŠ¥é”™ï¼š\nStatic pages not available. Configure KUDU_HOME or use the \u0026ndash;webserver_doc_root flag to fix page styling.\nç”±æŠ¥é”™ä¿¡æ¯å¯çŸ¥ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®KUDU_HOMEç¯å¢ƒå˜é‡æ¥è§£å†³ï¼Œä½†æ˜¯ç¬”è€…åœ¨å®è·µæ—¶è¿™ä¸€æ–¹æ³•å¤±æ•ˆäº†ï¼Œæ‰€ä»¥é‡‡å–äº†ç¬¬2ç§æ–¹æ³•ã€‚åŒæ—¶è¿™ä¸ªWebUIçš„è®¿é—®ç«¯å£ä¹Ÿå¯ä»¥é€šè¿‡â€“-webserver_portå‚æ•°æ¥ä¿®æ”¹ã€‚\ntserverèŠ‚ç‚¹éœ€è¦é¢å¤–é…ç½®ä¸€ä¸ª--tserver_master_addrså‚æ•°ï¼ŒæŒ‡å®šä¸€ä¸²masterèŠ‚ç‚¹åœ°å€çš„æ•°ç»„ã€‚ç”¨äºå°†tserverè¿æ¥åˆ°mastserèŠ‚ç‚¹ã€‚\nâ€“trusted_subnetså‚æ•°è®¾ç½®åœ¨masterä¸Šï¼Œä¸ºäº†è®©masterèŠ‚ç‚¹èƒ½å¤Ÿæ¥å—tserverèŠ‚ç‚¹çš„è¿æ¥è¯·æ±‚ï¼Œè¿™é‡Œè®¾ä¸º0.0.0.0/0æ¥å—æ‰€æœ‰çš„ipã€‚å½“ç„¶ä¹Ÿå¯ä»¥åªå•ç‹¬æ·»åŠ å…¶ä»–èŠ‚ç‚¹çš„ipã€‚\nå¯åŠ¨åè¿›å…¥masterèŠ‚ç‚¹çš„8051ç«¯å£ï¼Œç‚¹å‡»Tablet Serverså¯ä»¥çœ‹åˆ°èŠ‚ç‚¹å·²ç»è¿ä¸Š\n3. æ¨¡å¼è®¾è®¡ # Kuduçš„è¡¨æ ¼æ¨¡å‹ç»“æ„å’Œä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“çš„æ¨¡å‹ç±»ä¼¼ã€‚ä½†æ˜¯Kuduè¡¨çš„è®¾è®¡è¦æ³¨æ„çš„åœ°æ–¹åˆå’Œè¿™äº›RDBMSä¸å¤ªä¸€æ ·ã€‚åœ¨Kuduä¸­å»ºè¡¨æ—¶è¦ç€é‡å…³æ³¨ä»¥ä¸‹3ç‚¹ï¼š\nåˆ—è®¾è®¡ ä¸»é”®è®¾è®¡ åˆ†åŒºè®¾è®¡ å½“ç„¶å‰ä¸¤ç‚¹åœ¨RDBMSä¸­ä¹Ÿç»å¸¸æ¶‰åŠåˆ°ã€‚\n3.1 å®Œç¾çš„æ¨¡å¼ # Kuduçš„å®˜æ–¹ç½‘ç«™ä¸­ä»‹ç»äº†ä¸€ä¸ªå®Œç¾çš„æ¨¡å¼(Schema)åº”è¯¥æ»¡è¶³å“ªäº›æ¡ä»¶ï¼š\næ•°æ®çš„åˆ†å¸ƒæƒ…å†µèƒ½å¤Ÿä½¿æ¯ä¸ªæœåŠ¡å™¨æ¥æ”¶çš„è¯»å†™è¯·æ±‚é‡éƒ½å·®ä¸å¤šï¼Œè¿™æ ·æ¯å°æœåŠ¡å™¨çš„å‹åŠ›éƒ½ä¸ä¼šå¤ªå¤§ï¼Œä¹Ÿä¸ä¼šå¤ªå°ã€‚è¿™å–å†³äºåˆ†åŒºçš„è®¾è®¡ã€‚ Tabletsèƒ½å¤Ÿä»¥å¯é¢„æµ‹çš„é€Ÿåº¦å¹³ç¼“åœ°å¢é•¿ï¼Œå¹¶ä¸”è¯»å–Tabletsçš„è€—æ—¶ä¸ä¼šå‘ç”Ÿå¤ªå¤§çš„å˜åŒ–ã€‚è¿™ä¹Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šå—åˆ†åŒºçš„å½±å“ã€‚ è¯»å–æ“ä½œåªæ‰«ææŸ¥è¯¢æ‰€éœ€è¦çš„æ•°æ®ã€‚è¿™ä¸ªæ¡ä»¶ä¸€æ–¹é¢å–å†³äºä¸»é”®çš„è®¾è®¡ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¼šå—é€šè¿‡åˆ†åŒºè®¾è®¡è¿›è¡Œçš„åˆ†åŒºè£å‰ªçš„å½±å“ã€‚ 3.2 åˆ—è®¾è®¡ # Kuduæ”¯æŒä»¥ä¸‹åˆ—æ•°æ®ç±»å‹ï¼š\nBOOLï¼šå¸ƒå°”ç±»å‹ INT8ï¼š8ä½æœ‰ç¬¦å·æ•´æ•° INT32ï¼š32ä½æœ‰ç¬¦å·æ•´æ•° INT64ï¼š64ä½æœ‰ç¬¦å·æ•´æ•° DATEï¼š32ä½çš„å¤©æ•°ï¼Œä»¥Unixæ—¶é—´æˆ³è¡¨ç¤º UNIXTIME_MICROSï¼š64ä½çš„æ¯«ç§’æ•°ï¼Œä»¥Unixæ—¶é—´æˆ³è¡¨ç¤º FLOATï¼š32ä½æµ®ç‚¹æ•° DOUBLEï¼š64ä½æµ®ç‚¹æ•° DECIMALï¼šå›ºå®šç²¾åº¦æ•°å­—ç±»å‹ VARCHARï¼šä¸å®šé•¿å­—ç¬¦ä¸² STRINGï¼šUTF-8ç¼–ç çš„ä¸é™é•¿å­—ç¬¦ä¸²ï¼Œæœ€å¤§å­˜å‚¨64KBçš„æ•°æ®ï¼ˆæœªå‹ç¼©ï¼‰ BINARYï¼šäºŒè¿›åˆ¶æ•°æ®ï¼Œæœ€å¤§64KBï¼ˆæœªå‹ç¼©ï¼‰ Kuduæ˜¯ä½¿ç”¨åˆ—å¼å­˜å‚¨çš„ï¼Œæ‰€ä»¥åœ¨è®¾è®¡è¡¨çš„æ—¶å€™ï¼Œæœ€å¥½èƒ½å¤Ÿä¸ºæ¯ä¸€ä¸ªåˆ—æŒ‡å®šæœ€åˆé€‚çš„æ•°æ®ç±»å‹ï¼Œè€Œä¸æ˜¯ä¸€è‚¡è„‘åœ°å…¨éƒ¨è®¾ä¸ºSTRINGæˆ–è€…BINARYä¹‹ç±»çš„ã€‚\n","date":"2020å¹´8æœˆ1æ—¥","externalUrl":null,"permalink":"/tech/kudu-%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/","section":"Teches","summary":"","title":"Kudu éƒ¨ç½²æŒ‡å—","type":"tech"},{"content":"","date":"2020å¹´8æœˆ1æ—¥","externalUrl":null,"permalink":"/tags/nosql/","section":"Tags","summary":"","title":"Nosql","type":"tags"},{"content":"","date":"2020å¹´8æœˆ1æ—¥","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"2020å¹´8æœˆ1æ—¥","externalUrl":null,"permalink":"/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/","section":"Tags","summary":"","title":"å¤§æ•°æ®","type":"tags"},{"content":"","date":"2020å¹´8æœˆ1æ—¥","externalUrl":null,"permalink":"/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/","section":"Categories","summary":"","title":"æ•°æ®åº“","type":"categories"},{"content":" 1. æ¦‚è¿° # ä¸€ä¸ªå®Œæ•´çš„é‡‡é›†é“¾è·¯çš„æµç¨‹å¦‚ä¸‹ï¼š\næ‰€ä»¥è¦è¿›è¡Œé‡‡é›†é“¾è·¯çš„éƒ¨ç½²éœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥èšï¼š\nnginxçš„é…ç½® filebeatéƒ¨ç½² logstashéƒ¨ç½² kafkaéƒ¨ç½² kuduéƒ¨ç½² ä¸‹é¢å°†è¯¦ç»†è¯´æ˜å„ä¸ªéƒ¨åˆ†çš„éƒ¨ç½²æ–¹æ³•ï¼Œä»¥åŠä¸€äº›åŸºæœ¬çš„é…ç½®å‚æ•°ã€‚\n2. éƒ¨ç½²æµç¨‹ # nginx # 1. å®‰è£… # nginxå®‰è£…ç›´æ¥å»å®˜ç½‘ä¸‹è½½ä¸€ä¸ªå‹ç¼©æ–‡ä»¶è§£å‹ç„¶åç”¨sbin/nginxè¿è¡Œå°±å¯ä»¥äº†ã€‚\n2. é…ç½® # 2.1 æ—¥å¿—è¾“å‡ºæ ¼å¼ # nginxæ˜¯é‡‡é›†é“¾è·¯çš„ç¬¬ä¸€ä¸ªç¯èŠ‚ï¼Œåé¢çš„æ—¥å¿—é‡‡é›†ç³»ç»Ÿæ˜¯é€šè¿‡é‡‡é›†nginxæ—¥å¿—è¿›è¡Œåˆ†æçš„ã€‚æœ¬èŠ‚ä¸»è¦å¯¹nginxçš„æ—¥å¿—å¤„ç†çš„é…ç½®è¿›è¡Œæè¿°ã€‚\nå¯¹nginx.confæ–‡ä»¶è¿›è¡Œé…ç½®ï¼š\nlog_format log_json escape=json \u0026#39;{ \u0026#34;@timestamp\u0026#34;: \u0026#34;$time_local\u0026#34;, \u0026#39; \u0026#39;\u0026#34;remote_addr\u0026#34;: \u0026#34;$remote_addr\u0026#34;, \u0026#39; \u0026#39;\u0026#34;referer\u0026#34;: \u0026#34;$http_referer\u0026#34;, \u0026#39; \u0026#39;\u0026#34;project\u0026#34;: \u0026#34;$arg_project\u0026#34;, \u0026#39; \u0026#39;\u0026#34;request\u0026#34;: \u0026#34;$request\u0026#34;, \u0026#39; \u0026#39;\u0026#34;status\u0026#34;: $status, \u0026#39; \u0026#39;\u0026#34;bytes\u0026#34;: $body_bytes_sent, \u0026#39; \u0026#39;\u0026#34;request_body\u0026#34;: \u0026#34;$request_body\u0026#34;,\u0026#39; \u0026#39;\u0026#34;data\u0026#34;: \u0026#34;$arg_data\u0026#34;,\u0026#39; \u0026#39;\u0026#34;cookies\u0026#34;: \u0026#34;$http_cookie\u0026#34;\u0026#39; \u0026#39; }\u0026#39;; ä¸Šé¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªnginxçš„æ—¥å¿—è¾“å‡ºæ ¼å¼å¹¶å‘½åä¸ºlog_jsonï¼Œå¹¶ä¸”ä½¿ç”¨escape=jsonå‚æ•°æ¥æŠŠå˜é‡ä¸­å¯èƒ½åŒ…å«çš„jsonå­—ç¬¦ä¸²è‡ªåŠ¨è½¬ä¹‰ã€‚\nè¿™ä¸ªæ—¥å¿—è¾“å‡ºå“ªäº›å˜é‡éƒ½å¯ä»¥çµæ´»é…ç½®ï¼Œå–å†³äºé‡‡é›†æ¡†æ¶æ€ä¹ˆè¿›è¡Œæ•°æ®è§£æã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œå‰ç«¯å‘é€çš„è¯·æ±‚ä¸­ï¼ŒåŸ‹ç‚¹æ•°æ®å¯èƒ½å‡ºç°åœ¨request bodyä¸­ï¼Œä¹Ÿå¯èƒ½å‡ºç°åœ¨urlå‚æ•°ä¸­ä»¥data=xxxçš„å½¢å¼è½¬é€’ï¼Œæ‰€ä»¥å°†è¿™ä¸¤ä¸ªå˜é‡æ‰“å°åˆ°æ—¥å¿—ä¸­ã€‚\nè¾“å‡ºæ ¼å¼ä¹Ÿå¯ä»¥çµæ´»é…ç½®ï¼Œåœ¨logstashçš„è¾“å…¥è§£æä¸­è¿›è¡Œå¯¹åº”çš„è°ƒæ•´å°±å¯ä»¥äº†ã€‚ä½¿ç”¨jsonæ ¼å¼å¯ä»¥ç›´æ¥ç”¨jsonæ’ä»¶è¿›è¡Œè§£æï¼Œå¦åˆ™å¯èƒ½å°±è¦ç”¨grokæ’ä»¶è‡ªå·±å†™æ­£åˆ™è¿›è¡Œè§£æäº†ã€‚è¿™é‡Œæ¨èè¾“å‡ºä¸ºjsonæ ¼å¼ã€‚\n2.2 ç›‘å¬é…ç½® # ... http { ... server { listen 2346; access_log logs/data_tracking/access.log log_json; location / { error_page 405 =200 $request_uri; } } } é…ç½®ç›‘å¬åŸ‹ç‚¹ç«¯å£ï¼Œå°†è¯·æ±‚æ—¥å¿—æ‰“å°åˆ°å•ç‹¬çš„ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­é¿å…å’Œå…¶ä»–æ—¥å¿—æ··æ·†ï¼Œå¹¶æŒ‡å®šè¾“å‡ºæ ¼å¼ä¸ºä¸Šä¸€èŠ‚é…ç½®å¥½çš„log_jsonã€‚\nåŒæ—¶æŠŠæ ¹è¯·æ±‚çš„405ä»£ç è½¬å‘ä¸º200ï¼Œå› ä¸ºè¯·æ±‚ç›‘å¬çš„ç«¯å£å¹¶æ²¡æœ‰ä»»ä½•èµ„æºï¼Œè¯·æ±‚ä¼šè¿”å›status_code = 405ã€‚\nfilebeat # filebeatæ˜¯ä¸€æ¬¾å¼€æºçš„è½»é‡çº§æ—¥å¿—é‡‡é›†å·¥å…·ï¼Œä¸»è¦ç”¨äºæ•´åˆå„ä¸ªè·¯å¾„ä¸‹çš„å„ç§ä¸åŒçš„æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶ä¸”ç»Ÿä¸€è¾“å‡ºåˆ°æŒ‡å®šçš„è¾“å‡ºç‚¹ã€‚\nå¯¹äºfilebeatçš„é…ç½®è¾ƒä¸ºç®€å•ï¼Œè€Œfilebeatæä¾›çš„åŠŸèƒ½ä¹Ÿååˆ†æœ‰é™ï¼Œåªèƒ½è¿›è¡Œç®€å•çš„æ—¥å¿—é‡‡é›†å·¥ä½œï¼Œæ‰€ä»¥éœ€è¦å’Œlogstashé…å’Œä½¿ç”¨\n1. å®‰è£… # å¯ä»¥ç›´æ¥åœ¨å®˜ç½‘ä¸‹è½½rpmæˆ–debåŒ…ï¼š\nhttps://www.elastic.co/cn/downloads/beats/filebeat\nä¸‹è½½åç›´æ¥ä½¿ç”¨yum localinstall {pacakgeName}è¿›è¡Œå®‰è£…ã€‚\næˆ–è€…ä½¿ç”¨åŒ…ç®¡ç†è½¯ä»¶å¦‚ apt å’Œ yum è¿›è¡Œå®‰è£…ï¼š\né¦–å…ˆå¼•å…¥å…¬æœ‰ç­¾åkey\nsudo rpm --import https://packages.elastic.co/GPG-KEY-elasticsearch ç„¶åå†æ·»åŠ ä¸€ä¸ªrepoæ–‡ä»¶åˆ°/etc/yum.repos.d/ç›®å½•ä¸­\n[elastic-7.x] name=Elastic repository for 7.x packages baseurl=https://artifacts.elastic.co/packages/7.x/yum gpgcheck=1 gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch enabled=1 autorefresh=1 type=rpm-md æœ€åä½¿ç”¨yumå‘½ä»¤ç›´æ¥å®‰è£…å³å¯ã€‚\n2. é…ç½®å’Œå¯åŠ¨ # filebeaté»˜è®¤å®‰è£…åœ¨/usr/share/filebeatä¸‹\nfilebeatç›®å½•ç»“æ„è¯´æ˜ï¼š\nhome å®‰è£…çš„æ ¹ç›®å½• bin ä¸€äº›äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶ config é…ç½®æ–‡ä»¶ data æŒä¹…åŒ–çš„æ•°æ®æ–‡ä»¶ logs filebeatè¿è¡Œæ—¥å¿— åœ¨è¿è¡Œfilebeatå‰ï¼Œéœ€è¦å¯¹filebeatçš„ä¸€äº›è¿è¡Œå‚æ•°è¿›è¡Œé…ç½®ã€‚\né¦–å…ˆéœ€è¦åœ¨filebeatæ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªfilebeat.ymlé…ç½®æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­å†™å…¥å¦‚ä¸‹çš„å†…å®¹ï¼š\nfilebeat.inputs: - type: log enabled: true paths: - /var/log/*.log output.logstash: hosts:[\u0026#34;localhost:5044\u0026#34;] æ³¨æ„ï¼šæ‰€æœ‰çš„æ¨ªçº¿åéƒ½è¦ç©ºä¸€æ ¼ï¼Œä¸èƒ½ç›´æ¥è·Ÿå­—ç¬¦ä¸²ã€‚è¿™æ˜¯YAMLçš„è¯­æ³•æ ¼å¼ï¼Œå¯ä»¥å»äº†è§£ä¸€ä¸‹ã€‚\nfilebeat.inputsæŒ‡å®šäº†è¾“å…¥çš„é…ç½®ã€‚å…¶ä¸­typeæŒ‡å®šäº†è¾“å…¥çš„ç±»å‹æ˜¯æ—¥å¿—ç±»å‹ã€‚pathsæŒ‡å®šäº†è¾“å…¥æ–‡ä»¶çš„è·¯å¾„ï¼Œè¡¨ç¤ºè¯»å–/var/log/è·¯å¾„ä¸‹çš„æ‰€æœ‰.logç»“å°¾çš„æ–‡ä»¶ã€‚\noutput.logstashæŒ‡å®šäº†è¾“å‡ºåˆ°logstashçš„é…ç½®ã€‚å…¶ä¸­hostså¯ä»¥æŒ‡å®šä¸€ä¸ªæ•°ç»„ï¼Œå†™å…¥å¤šä¸ªè¾“å‡ºåœ°å€ã€‚\nè®¾ç½®å¼€æœºå¯åŠ¨filebeat\nsystemctl enable filebeat é€šè¿‡bin/filebeatæ–‡ä»¶å¯åŠ¨filebeatç”¨:\nbin/filebeat -e -c filebeat.yml 3. å’Œnginxçš„é…åˆ # é¦–å…ˆä¿®æ”¹filebeat.ymlä¸­çš„pathsï¼ŒæŒ‡å®šè¾“å…¥ä¸ºnginxåŸ‹ç‚¹æ—¥å¿—çš„è¾“å‡ºä½ç½®ã€‚\nä½¿ç”¨include_linesï¼ŒæŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼æ¥è¿‡æ»¤ä¸ç¬¦åˆè¦æ±‚çš„è¡Œã€‚\nnginxæ—¥å¿—è¾“å‡ºæ ¼å¼æ˜¯ä¸€ä¸ªè¯·æ±‚ä¸€è¡Œã€‚å¦åˆ™è¿›è¡Œå•è¡Œè¿‡æ»¤çš„æ—¶å€™ä¼šæœ‰å¤§é—®é¢˜ã€‚\nè¾“å‡ºé…ç½®æœ€å¥½æŒ‡å®šä¸ºå†…ç½‘ipã€‚\nfilebeat: inputs: - type: log enabled: true paths: - /usr/local/openresty/nginx/logs/data_tracking/access.log* include_lines: [\u0026#39;\u0026#34;project\u0026#34;: \u0026#34;test_bank_event\u0026#34;\u0026#39;] output.logstash: hosts: [\u0026#34;192.168.0.34:5055\u0026#34;] logstash # logstashç›¸å¯¹äºfilebeatå¹¶æ²¡æœ‰é‚£ä¹ˆè½»é‡ï¼Œä½†ç›¸å¯¹æ¥è¯´æœ‰æ›´å¤šçš„åŠŸèƒ½å’Œæ•°æ®å¤„ç†åŠŸèƒ½ã€‚æ‰€ä»¥ä¸€èˆ¬å°†filebeatå’Œlogstashç»“åˆä½¿ç”¨ã€‚ç”¨filebeatè¯»å–æ—¥å¿—æ–‡ä»¶å¹¶è¾“å‡ºåˆ°logstashä¸­ï¼Œå†è¿›è¡Œåç»­çš„æ•°æ®å¤„ç†ã€‚\n1. å®‰è£… # logstashçš„å®‰è£…æ–¹æ³•å’Œfilebeatçš„å®‰è£…åŸºæœ¬ç›¸åŒï¼Œå¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…è¿›è¡Œå®‰è£…ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚\nhttps://www.elastic.co/cn/downloads/logstash\n2. é…ç½®å’Œå¯åŠ¨ # logstash çš„é»˜è®¤å®‰è£…è·¯å¾„ä¹Ÿä½äº/usr/share/ç›®å½•ä¸‹ã€‚\nå…¶å¯åŠ¨æ–‡ä»¶æ˜¯å®‰è£…æ ¹ç›®å½•ä¸‹çš„bin/logstashï¼Œå¯¹äºä¸€äº›ç®€å•çš„é…ç½®ä¿¡æ¯ï¼Œå¯ä»¥ç›´æ¥ä»¥å‘½ä»¤è¡Œå‚æ•°çš„å½¢å¼æŒ‡å®šï¼š\nbin/logstash -e \u0026#39;input { stdin {}} output{ stdout{}}\u0026#39; è¿™è¡Œå‘½ä»¤æŒ‡å®šäº†æœ€åŸºæœ¬çš„inputå’Œoutputä¸ºæ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºã€‚å¯åŠ¨åç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥å†…å®¹ï¼Œå›è½¦åå°±å¯ä»¥çœ‹åˆ°ç»“æ„åŒ–å¤„ç†åçš„æ•°æ®è¾“å‡ºï¼š\nhello world /usr/share/logstash/vendor/bundle/jruby/2.5.0/gems/awesome_print-1.7.0/lib/awesome_print/formatters/base_formatter.rb:31: warning: constant ::Fixnum is deprecated { \u0026#34;@timestamp\u0026#34; =\u0026gt; 2020-06-08T03:38:04.658Z, \u0026#34;host\u0026#34; =\u0026gt; \u0026#34;hadoop\u0026#34;, \u0026#34;message\u0026#34; =\u0026gt; \u0026#34;hello world\u0026#34;, \u0026#34;@version\u0026#34; =\u0026gt; \u0026#34;1\u0026#34; } è¦è¿›è¡Œæ›´å¤šçš„é…ç½®ï¼Œæœ€å¥½åœ¨å®‰è£…æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª .confæ ¼å¼çš„é…ç½®æ–‡ä»¶ã€‚\nè¦å°†logstashå’Œfilebeatè”åˆä½¿ç”¨ï¼Œéœ€è¦è®©logstashæ¥å—ä¸€ä¸ªbeatsæ ¼å¼çš„è¾“å…¥ï¼š\ninput{ beats{ port =\u0026gt; \u0026#34;5044\u0026#34; } } # filter{ # # } output { stdout { codec =\u0026gt; rubydebug} } ä¸Šè¿°é…ç½®æŒ‡å®šäº†ä¸€ä¸ªbeatsç±»å‹çš„inputï¼Œå¹¶è®¾ç½®ç«¯å£ä¸º5044\nåœ¨å†™å¥½é…ç½®æ–‡ä»¶åå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¯¹é…ç½®è¿›è¡Œæ£€æŸ¥ï¼Œå…¶ä¸­-fæŒ‡å®šäº†è¦åŠ è½½çš„é…ç½®æ–‡ä»¶ï¼š\nbin/logstash -f first-pipeline.conf --config.test_and_exit --config.test_and_exitå‘½ä»¤ä¼šåŠ è½½é…ç½®æ–‡ä»¶å¹¶æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯ï¼Œå¹¶åœ¨è¾“å‡ºæ£€æŸ¥ç»“æœåè‡ªåŠ¨é€€å‡ºã€‚\nå¦‚æœæ£€æŸ¥é€šè¿‡ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¯åŠ¨logstashäº†ï¼š\nbin/logstash -f first-pipeline.conf --config.reload.automatic --config.reload.automaticå‘½ä»¤å¼€å¯äº†è‡ªåŠ¨é‡è½½é…ç½®çš„åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶åå¯ä»¥ä¸ç”¨é‡å¯æœåŠ¡ï¼Œlogstashä¼šè‡ªåŠ¨åŠ è½½æ›´æ–°åçš„é…ç½®ã€‚\nå¦‚æœåœ¨filebeatä¸­é…ç½®çš„è¾“å‡ºåœ°å€å’Œlogstashä¸­çš„è¾“å…¥beatsåœ°å€ç›¸åŒï¼Œé‚£ä¹ˆåœ¨å¯åŠ¨äº†è¿™ä¸¤ä¸ªæœåŠ¡åï¼Œlogstashå°±å¯ä»¥æ”¶åˆ°filebeatè¯»å–åˆ°çš„æ—¥å¿—å†…å®¹ã€‚å…¶åŸºæœ¬æ ¼å¼å’Œä¸Šæ–‡ä¸­ä»æ ‡å‡†è¾“å…¥è·å–æ•°æ®å¹¶è¾“å‡ºçš„æ ¼å¼ç±»ä¼¼ã€‚\n3. å’Œfilebeatçš„é…åˆ # åœ¨è¾“å…¥é…ç½®äº†å¯¹åº”çš„filebeatçš„ç«¯å£åï¼Œæ¥ä¸‹æ¥ä¸»è¦æ˜¯é…ç½®filteræ¨¡å—å¯¹æ—¥å¿—è¿›è¡Œè§£æï¼Œè¿™éƒ¨åˆ†ä¹Ÿè¦æ ¹æ®nginxæ—¥å¿—çš„ç»“æ„è¿›è¡Œçµæ´»çš„é…ç½®ã€‚filebeatä¸»è¦ç”¨æ¥æ”¶é›†æ•°æ®ä¼ è¾“ç»™logstashï¼Œå½“ç„¶filebeatä¸­ä¹Ÿå¯ä»¥è¿›è¡Œä¸€äº›ç®€å•çš„æ•°æ®å¤„ç†ï¼Œä½†è¿˜æ˜¯æ¨èfilebeatåªè´Ÿè´£æ”¶é›†æ—¥å¿—ï¼Œå‘é€åˆ°logstashè¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚\nä¸‹é¢æ˜¯ä¸€ä»½logstashçš„confæ–‡ä»¶ç”¨äºå‚è€ƒï¼š\nfilter{ # é¦–å…ˆå¯¹filebeatä¸­çš„æ•°æ®è¿›è¡Œè§£æï¼Œå…¶ä¸­\u0026#39;message\u0026#39;å¯¹åº”çš„å€¼æ‰æ˜¯æˆ‘ä»¬çœŸæ­£è¦è§£æçš„åŸ‹ç‚¹æ•°æ® # å…¶ä»–è¿˜æœ‰å¾ˆå¤šfilebeatè‡ªåŠ¨ç”Ÿæˆçš„æ•°æ®ã€‚ # è¿™é‡Œä½¿ç”¨jsonæ’ä»¶è¿›è¡Œè§£æï¼Œè§£æå®Œåå°±å¯ä»¥åˆ é™¤åŸæ¥çš„å˜é‡äº†ï¼Œå‡å°‘ä¸å¿…è¦çš„æ•°æ®ä¼ è¾“ json{ source =\u0026gt; \u0026#34;message\u0026#34; remove_field =\u0026gt; [\u0026#34;message\u0026#34;] } # å¯¹åŸ‹ç‚¹æ•°æ®è¿›è¡Œurlè§£ç ï¼Œå› ä¸ºåŸ‹ç‚¹æ•°æ®å¯èƒ½æ˜¯é€šè¿‡urlä¼ è¾“çš„ï¼Œå¯èƒ½ä¼šæœ‰è¿›è¡Œè¿‡urlç¼–ç  urldecode{ all_fields =\u0026gt; true } # ä½¿ç”¨rubyè¿›è¡Œbase64è§£ç ï¼Œç›®æ ‡æ˜¯\u0026#39;data\u0026#39;å˜é‡ï¼Œç»“æœèµ‹å€¼ç»™æ–°å»ºçš„\u0026#39;b64_decoded\u0026#39;å˜é‡ã€‚ ruby { init =\u0026gt; \u0026#34;require \u0026#39;base64\u0026#39;\u0026#34; code =\u0026gt; \u0026#34;event.set(\u0026#39;b64_decoded\u0026#39;, Base64.decode64(event.get(\u0026#39;data\u0026#39;))) if event.include?(\u0026#39;data\u0026#39;)\u0026#34; #è¿™é‡Œè§£ç å‡ºåˆšåˆšæˆªå–å‡ºæ¥çš„msgå­—æ®µ remove_field =\u0026gt; [\u0026#34;data\u0026#34;,\u0026#34;request\u0026#34;] } # åœ¨è§£ç åå†è¿›è¡Œä¸€æ¬¡jsonè§£æï¼ŒæŠŠjsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºjsonç»“æ„ä½“ json { source =\u0026gt; \u0026#34;b64_decoded\u0026#34; remove_field =\u0026gt; [\u0026#34;b64_decoded\u0026#34;] } } 4. å’Œkafkaçš„é…åˆ # ç”±äºæœ¬é“¾è·¯ä½¿ç”¨çš„å­˜å‚¨ä¸ºkuduæ•°æ®åº“ï¼Œè€Œlogstashæ˜¯ä¸æ”¯æŒç›´æ¥å†™å…¥kuduçš„ï¼›å¹¶ä¸”è¦è€ƒè™‘åˆ°å¹¶å‘å¤„ç†å’Œå®¹é”™ï¼Œæ‰€ä»¥è¦å…ˆå°†æ•°æ®å†™å…¥kafkaæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå†ç”±kafkaå†™å…¥kuduã€‚\nä¸»è¦æ˜¯é…ç½®confæ–‡ä»¶ä¸­çš„outputæ¨¡å—ï¼š\noutput{ kafka { # è¾“å‡ºä¸ºjsonæ ¼å¼ codec =\u0026gt; json # æŒ‡å®štopicä¸º\u0026#39;test_event\u0026#39; topic_id =\u0026gt; \u0026#34;test_event\u0026#34; } } å¿…è¦çš„é…ç½®å°±åªæœ‰topic_idï¼Œæ›´å¤šçš„é…ç½®å‚è€ƒlogstashå®˜æ–¹æ–‡æ¡£å¯¹kafkaæ’ä»¶çš„ä»‹ç»ã€‚\nâ€‹\n","date":"2020å¹´6æœˆ18æ—¥","externalUrl":null,"permalink":"/tech/%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86%E9%93%BE%E8%B7%AF%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/","section":"Teches","summary":"","title":"æ—¥å¿—é‡‡é›†é“¾è·¯éƒ¨ç½²æŒ‡å—","type":"tech"},{"content":" ä»€ä¹ˆæ˜¯åŒé‡åˆ†æ´¾ # ä»€ä¹ˆæ˜¯åˆ†æ´¾ï¼ˆdispatchï¼‰ # é¦–å…ˆæˆ‘ä»¬éœ€è¦ç†è§£ã€Œåˆ†æ´¾ã€çš„å«ä¹‰ã€‚åˆ†æ´¾å°±æ˜¯å°†æ–¹æ³•è°ƒç”¨ä¸å¯¹åº”çš„å…·ä½“æ–¹æ³•ç»‘å®šèµ·æ¥ã€‚è€Œåˆ¤æ–­çš„ä¾æ®æœ‰ä¸¤ç‚¹ï¼Œè¿™ä¸¤è€…å¯ç§°ä¸ºã€Œå®—é‡ã€ï¼š\næ–¹æ³•çš„æ¥æ”¶è€…ï¼Œä¹Ÿå°±æ˜¯å“ªä¸ªå¯¹è±¡è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³• æ–¹æ³•çš„å‚æ•°ï¼Œè°ƒç”¨æ–¹æ³•æ—¶ä¼ é€’è¿‡æ¥çš„å‚æ•° è€Œä¸åŒçš„åˆ¤æ–­æ–¹æ³•ä¹Ÿå°±äº§ç”Ÿäº†ä¸åŒçš„åˆ†æ´¾ç±»å‹ï¼š\né™æ€åˆ†æ´¾ V.S. åŠ¨æ€åˆ†æ´¾\nå•é‡åˆ†æ´¾ V.S. å¤šé‡åˆ†æ´¾\nä¸‹é¢ä»¥æˆ‘çš„ç†è§£ç®€å•åœ°æ€»ç»“ä¸€ä¸‹è¿™å‡ ä¸ªåè¯çš„å«ä¹‰\né™æ€åˆ†æ´¾ # é™æ€åˆ†æ´¾åœ¨ç¼–è¯‘æœŸè¿›è¡Œï¼Œåªæ ¹æ®å®—é‡çš„é™æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œåœ¨ç¼–è¯‘å®Œæˆåä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚ä¹Ÿå¯ç§°ä¸ºã€Œç¼–è¯‘æœŸå¤šæ€ã€\nåŠ¨æ€åˆ†æ´¾ # åŠ¨æ€åˆ†æ´¾åœ¨è¿è¡ŒæœŸè¿›è¡Œï¼Œæ ¹æ®å®—é‡çš„åŠ¨æ€ç±»å‹æ¥åˆ¤æ–­éœ€è¦è°ƒç”¨å“ªä¸ªæ–¹æ³•ã€‚ä¹Ÿç§°ã€Œè¿è¡Œæ—¶å¤šæ€ã€ã€‚\nå¤šé‡åˆ†æ´¾ # å¤šé‡åˆ†æ´¾å°±æ˜¯åŒæ—¶æ ¹æ®ä¸¤ç§å®—é‡çš„ç±»å‹è¿›è¡Œåˆ¤æ–­ã€‚å•é‡åˆ†æ´¾å°±æ˜¯åªæ ¹æ®å…¶ä¸­ä¸€ç§å®—é‡è¿›è¡Œåˆ¤æ–­ã€‚æ‰€ä»¥å…¶å®è¿™ä¸¤ç»„è¯æ˜¯ä»ä¸¤ä¸ªä¸åŒçš„è§’åº¦æ¥æè¿°åˆ†æ´¾çš„ç±»å‹ï¼Œå¹¶ä¸å†²çªã€‚\nè™½ç„¶è¯´ multiple æ˜¯ã€Œå¤šé‡ã€çš„æ„æ€ï¼Œä½†æ˜¯å®é™…ä¸Šä¹Ÿå¯ç§°ä¸ºã€ŒåŒé‡åˆ†æ´¾ã€ã€‚\nJava ä¸­çš„åˆ†æ´¾æœºåˆ¶ # åœ¨ç½‘ä¸Šå¾ˆå¤šåšå®¢è¯´ Java ä¸­æ˜¯å•é‡åˆ†æ´¾ï¼›ä¹Ÿæœ‰äººè¯´ Java ä¸­å®é™…ä¸Šæ˜¯é™æ€åŒé‡åˆ†æ´¾ï¼ŒåŠ¨æ€å•é‡åˆ†æ´¾ã€‚ä¸‹é¢æ˜¯æˆ‘çš„æ¨è®ºå’Œæ€»ç»“ã€‚\nJava ä¸­çš„é‡è½½æœºåˆ¶ï¼Œæ˜¯é™æ€åˆ†æ´¾ï¼Œå…¶æ ¹æ®æ–¹æ³•ä¼ å…¥å‚æ•°çš„é™æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œè€Œæ–¹æ³•çš„æ¥æ”¶è€…ï¼Œä¹Ÿç›´æ¥åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šã€‚æ‰€ä»¥æ˜¯é™æ€çš„åŒé‡åˆ†æ´¾ã€‚\nè€Œé‡å†™æœºåˆ¶ï¼Œè‚¯å®šæ˜¯åŠ¨æ€åˆ†æ´¾äº†ã€‚ä½†æ˜¯å…¶åªæ ¹æ®æ–¹æ³•æ¥æ”¶è€…çš„åŠ¨æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ã€‚å¹¶ä¸ä¼šæ ¹æ®æ–¹æ³•å‚æ•°çš„åŠ¨æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ã€‚æ‰€ä»¥æ˜¯åŠ¨æ€çš„å•é‡åˆ†æ´¾ã€‚\né‚£å¦‚æœä¸€ä¸ªæ–¹æ³•åŒæ—¶è¢«é‡å†™å’Œé‡è½½äº†å‘¢ï¼Œé‚£è¿™ä¸ªæ–¹æ³•å±äºä»€ä¹ˆåˆ†æ´¾æœºåˆ¶å‘¢ï¼Ÿæˆ‘è®¤ä¸ºï¼Œé‡å†™å’Œé‡è½½æœ¬æ¥å°±åˆ†åˆ«æ˜¯ç¼–è¯‘æœŸå’Œè¿è¡ŒæœŸçš„å¤šæ€æœºåˆ¶ï¼Œå°±æ˜¯åˆ†å¼€è¿›è¡Œè®¨è®ºçš„ï¼Œåœ¨ç¨‹åºä¸åŒç”Ÿå‘½å‘¨æœŸæ—¶é—´æ®µçš„åˆ†æ´¾æœºåˆ¶ç›´æ¥åˆ†å¼€è®¨è®ºå¹¶è¿›è¡Œå®šä¹‰å°±å¥½äº†ã€‚\nè®¿é—®è€…æ¨¡å¼ä¸ä¼ªåŒé‡åˆ†æ´¾ # è™½ç„¶è¯´ Java åœ¨ç¼–è¯‘æœŸè¡¨ç°å‡ºäº†å¤šé‡åˆ†æ´¾ï¼Œä½†æ˜¯ä¹Ÿåªèƒ½å®šæ€§ä¸ºå•é‡åˆ†æ´¾è¯­è¨€ï¼Œè€Œè¿™åœ¨è®¾è®¡ä»£ç æ—¶å°±ä¼šå¼•èµ·ä¸€äº›ä¸ä¾¿ï¼šåœ¨è°ƒç”¨æ–¹æ³•æ—¶æ— æ³•æ ¹æ®å‚æ•°çš„åŠ¨æ€ç±»å‹æ¥åˆ†æ´¾å¯¹åº”çš„æ–¹æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬åªèƒ½æ›²çº¿æ•‘å›½ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®ç°ä¼ªåŠ¨æ€åŒé‡åˆ†æ´¾ã€‚\n1. instanceof # åœ¨æ–¹æ³•å†…éƒ¨å¯ä»¥é€šè¿‡ Java çš„ instanceof å…³é”®å­—æ¥åˆ¤æ–­å¯¹è±¡çš„åŠ¨æ€ç±»å‹ã€‚é€šè¿‡åˆ†æ”¯é€‰æ‹©æ¥è¿›è¡Œå¯¹åº”çš„å¤„ç†æ“ä½œã€‚ä½†æ˜¯è¿™ç§æ€è·¯ä¼šè®©å¤„ç†ä»£ç å˜å¾—ååˆ†è‡ƒè‚¿ï¼Œè€Œä¸”è¿èƒŒäº†ã€Œå¼€é—­åŸåˆ™ã€ã€‚æ¯æ¬¡è¦æ–°å¢ä¸€ä¸ªè¢«å¤„ç†ç±»æ—¶ï¼Œå°±è¦ä¿®æ”¹ä»£ç æ–°å¢ä¸€ä¸ªåˆ†æ”¯è¿›è¡Œå¤„ç†ã€‚å…·ä½“çš„å®ç°æ–¹æ³•å¾ˆç®€å•ï¼Œä¸èµ˜è¿°ã€‚\n2. è®¿é—®è€…æ¨¡å¼ # è®¾è®¡æ¨¡å¼ä¸­çš„ã€Œè®¿é—®è€…æ¨¡å¼ã€å°±æ˜¯é€šè¿‡åˆ©ç”¨ä¼ªåŒé‡åˆ†æ´¾æ¥å®ç°çš„ã€‚ä¸»è¦æ€è·¯å¦‚ä¸‹ï¼š\nè®¾è°ƒç”¨æ–¹ä¸ºã€Œç±» A ã€ï¼Œè¢«è°ƒç”¨æ–¹ä¸ºã€Œç±» B ã€ã€‚é€šè¿‡åè½¬è°ƒç”¨æ–¹å’Œè¢«è°ƒç”¨æ–¹ï¼Œè®©ç±» A é‡å†™æ–¹æ³•æ¥è°ƒç”¨ç±» B çš„é‡è½½æ–¹æ³•ã€‚é€šè¿‡ this å˜é‡å°†ç±» A çš„åŠ¨æ€ç±»å‹ä¼ é€’ç»™ç±» B çš„é‡è½½æ–¹æ³•ï¼Œå®ç°äº†ä¼ªåŒé‡åˆ†æ´¾ã€‚\nåœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³è®© Player.play() æ–¹æ³•æ ¹æ® Instrument çš„åŠ¨æ€ç±»å‹æ¥åˆ†åˆ«è°ƒç”¨å¯¹åº”çš„é‡è½½æ–¹æ³•ï¼Œä»è€Œè¿›è¡Œä¸åŒçš„å¤„ç†ï¼š\nclass Player { void play(Instrument instrument) { System.out.println(\u0026#34;instrument notes\u0026#34;); } void play(Violin violin) { System.out.println(\u0026#34;player starts playing violin\u0026#34;); violin.note(); } void play(Piano piano) { System.out.println(\u0026#34;player starts playing piano\u0026#34;); piano.note(); } } class Instrument { void note() { System.out.println(\u0026#34;instrument notes\u0026#34;); } void accept(Player player) { player.play(this); } } class Violin extends Instrument { @Override public void note() { System.out.println(\u0026#34;violin notes\u0026#34;); } @Override public void accept(Player player) { player.play(this); } } class Piano extends Instrument { @Override public void note() { System.out.println(\u0026#34;piano notes\u0026#34;); } @Override public void accept(Player player) { player.play(this); } } public class Main { public static void main(String[] args) { Player player = new Player(); System.out.println(\u0026#34;-------åŒé‡åˆ†æ´¾-------\u0026#34;); Instrument[] instruments = {new Violin(), new Piano()}; for (Instrument instrument : instruments) { instrument.accept(player); } System.out.println(\u0026#34;-------å•é‡åˆ†æ´¾-------\u0026#34;); for (Instrument instrument : instruments) { player.play(instrument); } } } // ç»“æœ /* -------åŒé‡åˆ†æ´¾------- player starts playing violin violin notes player starts playing piano piano notes -------å•é‡åˆ†æ´¾------- instrument notes instrument notes */ ä»ä¸Šæ–¹çš„ä»£ç è¿è¡Œç»“æœå¯ä»¥å¾—çŸ¥ï¼Œåœ¨è°ƒç”¨é‡è½½æ–¹æ³•æ—¶ï¼Œä¸ä¼šæ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œè€Œæ˜¯æ ¹æ®é™æ€ç±»å‹åˆ¤æ–­ï¼Œåªä¼šè°ƒç”¨ play(Instrument) æ–¹æ³•ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬åœ¨é‡è½½ Player çš„æ–¹æ³•æ—¶å¯ä»¥ç›´æ¥è°ƒç”¨ Instrument.note() æ–¹æ³•ï¼Œè®©ç¼–è¯‘å™¨å»è°ƒç”¨å­ç±»é‡å†™åçš„æ–¹æ³•ã€‚\nä½†æ˜¯ä½¿ç”¨åŒé‡åˆ†æ´¾çš„æ„ä¹‰åœ¨äºï¼ŒæŠŠå…·ä½“çš„å¤„ç†é€»è¾‘æ”¾åœ¨è°ƒç”¨è€… Player ç±»çš„æ–¹æ³•ä¸­ï¼Œå‡å°‘å¯¹ Instrument çš„å®ç°ç±»çš„ä¿®æ”¹ã€‚äº‹å®ä¸Š Instrument çš„å­ç±»åªéœ€è¦å®ç°ä¸€ä¸ª accept(Player) æ–¹æ³•å³å¯ã€‚\nè®¿é—®è€…æ¨¡å¼çš„å‡ºç°åŸºæœ¬ä¸Šä¹Ÿå°±æ˜¯å› ä¸º Java è¿™ç±»è¯­è¨€çš„å•é‡åˆ†æ´¾ç‰¹æ€§å§ã€‚å¦‚æœæ˜¯å¤šé‡åˆ†æ´¾çš„è¯­è¨€ï¼Œå°±å¯ä»¥ç›´æ¥åˆ©ç”¨è¯­è¨€ç‰¹æ€§äº†ã€‚\nå‚è€ƒæ–‡ç« ï¼š\né¢å‘å¯¹è±¡è¯­è¨€çš„å¤šåˆ†æ´¾ã€å•åˆ†æ´¾ã€åŒé‡åˆ†æ´¾\nhttps://www.cnblogs.com/youxin/archive/2013/05/25/3099016.html\nWhat is dispatching in JAVA?\nhttps://stackoverflow.com/questions/5508274/what-is-dispatching-in-java\n","externalUrl":null,"permalink":"/life/untitled/","section":"Lives","summary":"","title":"","type":"life"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]